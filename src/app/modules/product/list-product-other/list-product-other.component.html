<div class="card card-custom gutter-b mt-1">
	<div class="card-header">
		<div class="card-title">
			<h3 class="card-label">Tìm kiếm sản phẩm</h3>
		</div>
	</div>

	<div class="card-body">
		<form [formGroup]="searchForm">
			<div class="form-group row px-3">
				<div class="col-lg-4">
					<label>Nhóm sản phẩm</label>
					<select
						class="form-control form-control-solid form-control-lg"
						formControlName="productType"
					>
						<option [value]="''">Tất cả</option>
						<option *ngFor="let item of productTypes" [value]="item.id">{{item.name}}</option>
					</select>
				</div>

				<div class="col-lg-4">
					<label>Tên sản phẩm</label>
					<input
						type="text"
						class="form-control form-control-solid form-control-lg"
						placeholder="Nhập tên sản phẩm"
						formControlName="productName"
						autocomplete="off"
						maxlength="199"
						trim="blur"
					/>
				</div>

				<div class="col-lg-4">
					<label>Giá nhập</label>
					<div class="input-group">
						<input
							type="text"
							class="form-control form-control-solid form-control-lg text-center"
							placeholder="Từ"
							formControlName="importPriceFrom"
							decimal-mask
						/>
						<div class="input-group-prepend input-group-append">
							<span class="input-group-text"> -> </span>
						</div>
						<input
							type="text"
							class="form-control form-control-solid form-control-lg text-center"
							placeholder="Đến"
							formControlName="importPriceTo"
							decimal-mask
						/>
					</div>
				</div>
			</div>

			<div class="form-group row px-3">
				<div class="col-lg-4">
					<label>Mã sản phẩm</label>
					<input
						type="text"
						class="form-control form-control-solid form-control-lg"
						placeholder="Nhập mã sản phẩm"
						formControlName="productCode"
						autocomplete="off"
						maxlength="199"
						trim="blur"
					/>
				</div>

				<div class="col-lg-4">
					<label>Trạng thái</label>
					<select class="form-control form-control-solid form-control-lg" formControlName="status">
						<option [value]="''">Tất cả</option>
						<option [value]="listStatus.ACTIVE">Hoạt động</option>
						<option [value]="listStatus.INACTIVE">Không hoạt động</option>
					</select>
				</div>

				<div class="col-lg-4">
					<label>Giá bán</label>
					<div class="input-group">
						<input
							type="text"
							class="form-control form-control-solid form-control-lg text-center"
							placeholder="Từ"
							formControlName="exportPriceFrom"
							decimal-mask
						/>
						<div class="input-group-prepend input-group-append">
							<span class="input-group-text" id=""> -> </span>
						</div>
						<input
							type="text"
							class="form-control form-control-solid form-control-lg text-center"
							placeholder="Đến"
							formControlName="exportPriceTo"
							decimal-mask
						/>
					</div>
				</div>
			</div>

			<div class="form-group row px-3">
				<div class="col-lg-4">
					<label>Tạo QR code</label>
					<select class="form-control form-control-solid form-control-lg" formControlName="qrCode">
						<option [value]="''">Tất cả</option>
						<option [value]="listStatusQr.YES">Đã tạo</option>
						<option [value]="listStatusQr.NO">Chưa tạo</option>
					</select>
				</div>
			</div>
		</form>

		<div class="form-group row mx-3">
			<button type="button" class="btn btn-primary mr-3" (click)="onSearch()">
				<em class="fas fa-search"> Tìm kiếm</em>
			</button>
			<button type="button" class="btn btn-secondary" (click)="onReset()">Nhập lại</button>
		</div>
	</div>
</div>

<div class="card card-custom gutter-b mt-1">
	<div class="card-header">
		<div class="card-title">
			<h3 class="card-label">Danh sách sản phẩm</h3>
		</div>

		<div class="card-toolbar row">
			<button type="button" class="btn btn-primary" (click)="createModal()">Thêm mới</button>
		</div>
	</div>

	<div class="card-body">
		<div class="table-responsive angular-bootstrap-table">
			<table class="table table-head-custom table-vertical-center overflow-hidden" aria-label="">
				<thead>
					<th class="code" scope="">
						Mã sản phẩm
						<app-sort-icon
							column="code"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="category" scope="">
						Nhóm sản phẩm
						<app-sort-icon
							column="categoryId"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="name" scope="">
						Tên sản phẩm
						<app-sort-icon
							column="name"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="entry-price text-right" scope="">
						Giá nhập
						<app-sort-icon
							column="entryPrice"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="price text-right" scope="">
						Giá bán
						<app-sort-icon
							column="price"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="unit" scope="">
						Đơn vị
						<app-sort-icon
							column="unit"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="vat text-right" scope="">
						VAT (%)
						<app-sort-icon
							column="valueAddedTax"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="status" scope="">
						Trạng thái
						<app-sort-icon
							column="status"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="qr-code" scope="">
						Tạo QR code
						<app-sort-icon
							column="qrCode"
							[activeColumn]="sortData?.fieldSort"
							[activeDirection]="sortData?.directionSort"
							(sort)="sort($event)"
						></app-sort-icon>
					</th>
					<th class="action text-center" scope="">Tác động</th>
				</thead>

				<tbody>
					<tr *ngFor="let item of dataSource">
						<td class="code">
							<p class="cursor-pointer text-ellipsis" placement="top" [ngbTooltip]="item.code">
								{{ item.code }}
							</p>
						</td>
						<td class="category">
							<p
								class="cursor-pointer text-ellipsis"
								placement="top"
								[ngbTooltip]="item.nameCategory"
							>
								{{ item.nameCategory }}
							</p>
						</td>
						<td class="name">
							<p class="cursor-pointer text-ellipsis" placement="top" [ngbTooltip]="item.name">
								{{ item.name }}
							</p>
						</td>
						<td class="price text-right">
							<p
								class="cursor-pointer text-ellipsis"
								placement="top"
								[ngbTooltip]="item.entryPrice?.toLocaleString('en-US')"
							>
								{{ item.entryPrice?.toLocaleString('en-US') }}
							</p>
						</td>
						<td class="entry-price text-right">
							<p
								class="cursor-pointer text-ellipsis"
								placement="top"
								[ngbTooltip]="item.price?.toLocaleString('en-US')"
							>
								{{ item.price?.toLocaleString('en-US') }}
							</p>
						</td>
						<td class="unit">
							<p class="cursor-pointer text-ellipsis" placement="top" [ngbTooltip]="item.unit">
								{{ item.unit }}
							</p>
						</td>
						<td class="vat text-right">
							<p
								class="cursor-pointer text-ellipsis"
								placement="top"
								[ngbTooltip]="item.valueAddedTax + '%'"
							>
								{{ item.valueAddedTax || '-'}}
							</p>
						</td>
						<td class="status">
							<span
								class="label label-lg label-inline"
								[class.label-light-success]="item.status === listStatus.ACTIVE"
								[class.label-light-danger]="item.status !== listStatus.ACTIVE"
							>
								<ng-container *ngIf="item.status === listStatus.ACTIVE">Hoạt động</ng-container>
								<ng-container *ngIf="item.status === listStatus.INACTIVE">
									Không hoạt động
								</ng-container>
							</span>
						</td>
						<td class="qr-code">
							<p
								class="cursor-pointer text-ellipsis"
								placement="top"
								[ngbTooltip]="item.createQrCode ? 'Đã tạo' : 'Chưa tạo'"
							>
								<ng-container *ngIf="item.createQrCode">Đã tạo</ng-container>
								<ng-container *ngIf="!item.createQrCode">Chưa tạo</ng-container>
							</p>
						</td>
						<td class="action">
							<a
								(click)="createModal($event, item)"
								class="btn btn-icon btn-light btn-hover-primary btn-sm mx-3"
							>
								<span
									[inlineSVG]="'./assets/media/svg/icons/Communication/Write.svg'"
									cacheSVG="true"
									class="svg-icon svg-icon-md svg-icon-primary"
									[ngbTooltip]="'Sửa'"
								>
								</span>
							</a>
							<a
								(click)="deleteProduct($event, item)"
								class="btn btn-icon btn-light btn-hover-danger btn-sm"
							>
								<span
									[inlineSVG]="'./assets/media/svg/icons/General/Trash.svg'"
									cacheSVG="true"
									class="svg-icon svg-icon-md svg-icon-danger"
									[ngbTooltip]="'Xóa'"
								>
								</span>
							</a>
						</td>
					</tr>
				</tbody>

				<tfoot *ngIf="dataSource?.length === 0">
					<tr>
						<td colspan="10" class="text-center" style="color: #ccc">Không có bản ghi nào</td>
					</tr>
				</tfoot>
			</table>
		</div>

		<app-paginator [paginator]="paginatorState" (paginate)="pagingChange($event)"></app-paginator>
	</div>
</div>
