<div class="mt-1 card card-custom gutter-b">
	<div class="revenue-detail">
		<div class="card-header">
			<div class="card-title pt-3">
				<h3 class="title">Chi tiết khuyến mãi</h3>
			</div>
		</div>

		<div class="card-body">
			<div class="table-responsive angular-bootstrap-table">
				<table class="table table-head-custom table-vertical-center overflow-hidden" aria-label="">
					<thead>
						<th scope="">Loại sản phẩm</th>
						<th scope="">Đơn vị</th>
						<th scope="" class="text-right head-inventory">Tồn đầu</th>
						<th scope="" [ngClass]='statusLockShift === "CLOSE" ? "text-right" : ""'>Nhập</th>
						<th scope="" [ngClass]='statusLockShift === "CLOSE" ? "text-right" : ""'>Xuất</th>
						<th scope="" [ngClass]='statusLockShift === "CLOSE" ? "text-right" : ""'>Số lượng thực tế</th>
						<th scope="" class="text-right final-inventory">Tồn cuối</th>
						<th scope="" class="text-right compensate-quantity">Bù</th>
					</thead>

					<ng-container *ngIf='statusLockShift !== "CLOSE"'>
						<tbody>
							<tr *ngFor="let item of dataSourceForm.controls; let i = index" [formGroup]="item">
								<td class="name">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.get('productName').value"
									>
										{{ item.get('productName').value }}
									</p>
								</td>
								<td class="unit">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.get('unit').value"
									>
										{{ item.get('unit').value }}
									</p>
								</td>
								<td class="head-inventory text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.get('headInventory').value.toLocaleString('en-US')"
									>
										{{ item.get('headInventory').value.toLocaleString('en-US') }}
									</p>
								</td>
								<td class="import-quantity">
									<input
										class="form-control"
										formControlName="importQuantity"
										placeholder="Nhập số lượng nhập"
										decimal-mask
										maxlength="13"
										(input)="totalScore(i)"
									/>
									<app-validate
										[control]="item.get('importQuantity')"
										[error]="'required'"
										[message]="'Số lượng nhập không được để trống'"
									></app-validate>
								</td>
								<td class="export-quantity">
									<input
										class="form-control"
										formControlName="exportQuantity"
										placeholder="Nhập số lượng xuất"
										decimal-mask
										maxlength="13"
                    (input)="totalScore(i)"
									/>
									<app-validate
										[control]="item.get('exportQuantity')"
										[error]="'required'"
										[message]="'Số lượng xuất không được để trống'"
									></app-validate>
								</td>
								<td class="actual-inventory-quantity text-right">
									<input
										class="form-control"
										formControlName="actualInventoryQuantity"
										placeholder="Nhập số lượng thực tế"
										decimal-mask
										maxlength="13"
										(input)="totalScore(i)"
									/>
									<app-validate
										[control]="item.get('actualInventoryQuantity')"
										[error]="'required'"
										[message]="'Số lượng thực tế không được để trống'"
									></app-validate>
								</td>
								<td class="final-inventory text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.get('finalInventory').value?.toLocaleString('en-US') || '0'"
									>
										{{ item.get('finalInventory').value?.toLocaleString('en-US') || 0 }}
									</p>
								</td>
								<td class="compensate-quantity text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.get('compensateQuantity').value.toLocaleString('en-US')"
									>
										{{ item.get('compensateQuantity').value.toLocaleString('en-US') }}
									</p>
								</td>
							</tr>
						</tbody>

						<tfoot>
							<tr *ngIf="dataSourceForm?.length === 0">
								<td colspan="13" class="text-center" style="color: #ccc">Không có bản ghi nào</td>
							</tr>
						</tfoot>
					</ng-container>

					<ng-container *ngIf='statusLockShift === "CLOSE"'>
						<tbody>
							<tr *ngFor="let item of dataSource; let i = index">
								<td class="name">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.productName"
									>
										{{ item.productName }}
									</p>
								</td>
								<td class="unit">
									<p class="cursor-pointer text-ellipsis" placement="top" [ngbTooltip]="item.unit">
										{{ item.unit }}
									</p>
								</td>
								<td class="head-inventory text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.headInventory.toLocaleString('en-US')"
									>
										{{ item.headInventory.toLocaleString('en-US') }}
									</p>
								</td>
								<td class="import-quantity text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.importQuantity.toLocaleString('en-US')"
									>
										{{ item.importQuantity.toLocaleString('en-US') }}
									</p>
								</td>
								<td class="export-quantity text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.exportQuantity.toLocaleString('en-US')"
									>
										{{ item.exportQuantity.toLocaleString('en-US') }}
									</p>
								</td>
								<td class="actual-inventory-quantity text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.actualInventoryQuantity.toLocaleString('en-US')"
									>
										{{ item.actualInventoryQuantity.toLocaleString('en-US') }}
									</p>
								</td>
								<td class="final-inventory text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.finalInventory?.toLocaleString('en-US') || '0'"
									>
										{{ item.finalInventory?.toLocaleString('en-US') || 0 }}
									</p>
								</td>
								<td class="compensate-quantity text-right">
									<p
										class="cursor-pointer text-ellipsis"
										placement="top"
										[ngbTooltip]="item.compensateQuantity.toLocaleString('en-US')"
									>
										{{ item.compensateQuantity.toLocaleString('en-US') }}
									</p>
								</td>
							</tr>
						</tbody>

						<tfoot>
							<tr *ngIf="dataSource?.length === 0">
								<td colspan="13" class="text-center" style="color: #ccc">Không có bản ghi nào</td>
							</tr>
						</tfoot>
					</ng-container>
				</table>
			</div>
		</div>
	</div>

	<div class="py-5 w-100 d-flex justify-content-center">
		<button
      *ngIf='statusLockShift === "CLOSE"'
      class="m-2 btn btn-primary font-weight-bold"
      (click)='nextStep()'
    >
      Tiếp theo
    </button>
		<button
			*ngIf='statusLockShift !== "CLOSE"'
			class="m-2 btn btn-primary font-weight-bold"
			(click)="onSubmit()"
		>
			Xác nhận
		</button>
	</div>
</div>
