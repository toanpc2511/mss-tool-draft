<app-progress-spinner [color]="color" [mode]="mode" [value]="value" *ngIf="isShowLoading"
                      class="sq-global-backdrop center-aligned">
</app-progress-spinner>
<app-card-services-form [formGroup]="formCustomerInfo" [title]="'Thêm/ Hủy TK liên kết/ Đổi tài khoản mặc định'"
                        [isShowLoading]="isShowLoading"
                        [allowEditAction]="true"
                        (eventBackStep)="backToSearch($event)"
                        (eventOpenModal)="openModal()">
  <div class="field">
    <span class="txtLabel">Loại khách hàng:</span>
    <input type="text" formControlName="clientType" class="form-control">
  </div>
  <div class="field">
    <span class="txtLabel">Chi nhánh:</span>
    <input type="text" formControlName="branchCode" class="form-control">
  </div>
  <div class="field">
    <span class="txtLabel">Số hợp đồng:</span>
    <input type="text" formControlName="contract" class="form-control">
  </div>
  <div class="field">
    <span class="txtLabel">Loại hợp đồng:</span>
    <input type="text" formControlName="contractType" class="form-control">
  </div>
  <div class="field">
    <span class="txtLabel">Tài khoản mặc định:</span>
    <input type="text" formControlName="defaultAccount" class="form-control">
  </div>

  <div class="row-fields mb-2">
    <div style="padding-bottom: 20px">
      <span class="text-label">Danh sách các tài khoản</span>
    </div>
    <div class="mini-table">
      <table class="table">
        <thead>
        <tr>
          <th scope="col">STT</th>
          <th scope="col">Số tài khoản</th>
          <th scope="col">Liên kết / Hủy Liên kết</th>
          <th scope="col">Mặc định</th>
        </tr>
        </thead>
        <tbody formArrayName="lstAccountSVBO">
        <tr>
          <th scope="row" colspan="4"><p class="d-flex justify-content-start">Số tài khoản trên SVBO</p></th>
        </tr>

        <tr *ngFor="let info1 of lstAccountSVBO.controls; let i = index " tabindex="0" [formGroupName]="i">
          <td>{{i + 1}}</td>
          <td>{{info1.value.accountNumberSVBO}}</td>
          <td>
            <p class="d-flex justify-content-center">
              <mat-checkbox color="primary" formControlName="linkStatusSVBO"
                            [checked]="info1.value.linkStatusCBS === true"
                            (change)="evtCheckedLinkAccountChange($event, POSITION_SELECT.SVBO, i)" ></mat-checkbox>
            </p>
          </td>
          <td>
            <p class="d-flex justify-content-center">
              <mat-radio-group name="primaryGroup1" formControlName="defaultAccSVBO" (change)="evtRadioDefaultAccountChange(POSITION_SELECT.SVBO, i)">
                <mat-radio-button color="primary" id="{{'accSvbo' + i}}" name="primaryGroup1"
                                  [value]="true"
                                  [checked]="info1.value.defaultAccSVBO"></mat-radio-button>
              </mat-radio-group>
            </p>
          </td>
        </tr>
        </tbody>

        <tbody formArrayName="listAccountCBS">
        <tr>
          <th scope="row" colspan="4"><p class="d-flex justify-content-start">Số tài khoản trên CBS</p></th>
        </tr>

        <tr *ngFor="let info2 of listAccountCBS.controls; let i = index " tabindex="0" [formGroupName]="i">
          <td>{{i + 1}}</td>
          <td>{{info2.value.accountNumberCBS}}</td>
          <td>
            <p class="d-flex justify-content-center">

              <mat-checkbox color="primary" formControlName="linkStatusCBS"
                            [checked]="info2.value.linkStatusCBS === true"
                            (change)="evtCheckedLinkAccountChange($event, POSITION_SELECT.CBS, i)"></mat-checkbox>
            </p>
          </td>
          <td>
            <p class="d-flex justify-content-center">
              <mat-radio-group name="primaryGroup1" formControlName="defaultAccCBS" (change)="evtRadioDefaultAccountChange(POSITION_SELECT.CBS, i)">
                <mat-radio-button color="primary" id="{{'accCbs'+ i}}" name="primaryGroup1"
                                  [value]= "true"
                                  [checked]="this.listAccountCBS.controls[i].value.defaultAccCBS === true"></mat-radio-button>
              </mat-radio-group>
            </p>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="button-group">
    <button class="btn btn-primary mr-2 btn-action-back"
            (click)="backToSearch($event)">Quay lại
    </button>
    <button class="btn btn-primary btn-action-reset mr-2"
            (click)="resetForm()">Reset
    </button>
    <button class="btn btn-success mr-2" (click)="printForm()" >In Biểu Mẫu</button>
    <button *ngIf="isPrinted" class="btn btn-primary btn-action-send"
            (click)="editingAccount()">Gửi duyệt
    </button>
  </div>
</app-card-services-form>

<!-- Modal confirm -->
<app-lpb-modal headerText="Xác nhận gửi duyệt Thêm /Hủy TK liên kết /Đổi tài khoản mặc định" [show]="showModal"
               (hideModal)="showModal = false"
               [widthContent]="50" [unit]="'%'" marginTop="200px">
  <div class="confirm-content">
    <div class="mb-2 confirm-txt">
      Bạn có chắc muốn gửi duyệt dịch vụ Thêm / Hủy TK liên kết / Đổi tài khoản mặc định
    </div>
    <div class="mb-2 confirm-txt" *ngIf="cardSelected?.cardNumber">
      Số thẻ: {{cardSelected?.cardNumber}}
    </div>
    <div class="mt-4">
      <button class="btn btn-denied mr-2" (click)="this.showModal = false">
        Hủy bỏ
      </button>
      <button class="btn btn-accept" (click)="editingAccount()">
        Đồng ý
      </button>
    </div>
  </div>
</app-lpb-modal>
<!-- Modal confirm -->
